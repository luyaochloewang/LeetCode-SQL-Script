#615. Average Salary: Departments VS Company ***
with cte as (select date_format(s.pay_date,'%Y-%m') as pay_month, e.department_id, avg(s.amount) as avg_amount
from salary s
join employee e on s.employee_id = e.employee_id
group by pay_month, e.department_id),

cte1 as (select date_format(pay_date,'%Y-%m') as pay_month, avg(amount) as am
from salary 
group by pay_month)

select cte1.pay_month, cte.department_id, 
           case when cte.avg_amount > cte1.am then 'higher'
                when cte.avg_amount < cte1.am then 'lower'
                when cte.avg_amount = cte1.am then 'same'
                else null
           end as comparison
 from cte
 left join cte1
 on cte.pay_month= cte1.pay_month;

#618. Students Report By Geography ***
with murica as
(select name as america, row_number() over(order by name) as row_num 
from student
where continent = 'America'),
asia as
(select name as asia, row_number() over(order by name) as row_num
from student
where continent = 'Asia'), europe as
(select name as europe, row_number() over(order by name) as row_num
from student
where continent = 'Europe')
select america, asia, europe
from murica a
left join asia aa on a.row_num = aa.row_num
left join europe e on a.row_num = e.row_num

#619. Biggest Single Number
SELECT MAX(num) AS num
FROM (SELECT num FROM my_numbers GROUP BY num HAVING COUNT(num) = 1) AS t;

#620. Not Boring Movies 
# find all odd result, use (column % 2)
# Return the remainder of 18/4 (SELECT 18 MOD 4;) 
Select * from Cinema
where (id % 2) = 1
and description <> 'boring'
order by rating desc 

#626. Exchange Seats
Select if(id < (select count(*) from seat), if(id mod 2=0, id-1, id+1), if(id mod 2=0, id-1, id)) as id, student
from seat 
order by id asc;

#627. Swap Salary
# Update method. use CASE WHEN to swap
UPDATE salary
SET sex  = (CASE WHEN sex = 'm' 
            THEN  'f' 
            ELSE 'm' 
            END)
            
#1045. Customers Who Bought All Products

#1050. Actors and Directors Who Cooperated At Least Three Times

#1068. Product Sales Analysis I

#1069. Product Sales Analysis II

#1070. Product Sales Analysis III

#
#
#
#
#
#
#
#
#
